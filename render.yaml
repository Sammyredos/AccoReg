services:
  - type: web
    name: Mopgomyouth
    env: node
    plan: free
    region: oregon
    # Optimized for real-time features
    autoDeploy: true
    previewsEnabled: false
    buildCommand: |
      echo "üöÄ Starting Mopgomyouth production build process..." &&
      echo "üì¶ Installing dependencies..." &&
      npm ci &&
      echo "üîß Generating Prisma client..." &&
      npx prisma generate &&
      echo "‚úÖ Database client ready" &&
      echo "üëë Setting up Super Admin account..." &&
      (npx tsx scripts/create-super-admin.ts && echo "‚úÖ Super Admin account ready (admin@mopgomglobal.com)" || echo "‚ö†Ô∏è Admin creation skipped (may already exist)") &&
      echo "‚öôÔ∏è Seeding system settings..." &&
      (npx tsx scripts/seed-settings.ts && echo "‚úÖ Settings seeded successfully" || echo "‚ö†Ô∏è Settings seeding skipped (may already exist)") &&
      echo "üé® Updating branding and settings..." &&
      (npx tsx scripts/update-branding.ts && echo "‚úÖ Branding updated successfully" || echo "‚ö†Ô∏è Branding update skipped") &&
      echo "üë• Setting up roles and permissions..." &&
      (npx tsx scripts/create-staff-role.ts && echo "‚úÖ Roles and permissions configured" || echo "‚ö†Ô∏è Role setup skipped") &&
      echo "üèóÔ∏è Building Next.js application with production optimizations..." &&
      NODE_ENV=production npm run build &&
      echo "üßπ Cleaning up development dependencies..." &&
      npm prune --production &&
      echo "üéâ Mopgomyouth production build completed successfully!" &&
      echo "üîó Your app will be available at: https://mopgomyouth.onrender.com" &&
      echo "üìä Build Summary:" &&
      echo "  ‚úÖ Dependencies installed and optimized" &&
      echo "  ‚úÖ Database schema deployed" &&
      echo "  ‚úÖ Admin account configured" &&
      echo "  ‚úÖ System settings initialized" &&
      echo "  ‚úÖ Branding and roles configured" &&
      echo "  ‚úÖ Next.js application built for production" &&
      echo "  ‚úÖ Production dependencies optimized" &&
      echo "üöÄ Ready for deployment!"
    startCommand: |
      echo "üåü Starting Mopgomyouth Youth Registration System..." &&
      echo "üîß Environment: Production" &&
      echo "üóÑÔ∏è Database: PostgreSQL" &&
      echo "üëë Setting up Super Admin account..." &&
      (npx tsx scripts/create-super-admin.ts && echo "‚úÖ Super Admin ready" || echo "‚ö†Ô∏è Admin setup skipped") &&
      echo "‚öôÔ∏è Seeding system settings..." &&
      (npx tsx scripts/seed-settings.ts && echo "‚úÖ Settings ready" || echo "‚ö†Ô∏è Settings setup skipped") &&
      echo "üåê Starting server..." &&
      npm start
    envVars:
      - key: NODE_ENV
        value: production
      - key: NEXT_TELEMETRY_DISABLED
        value: 1
      - key: PRISMA_GENERATE_SKIP_AUTOINSTALL
        value: true
      - key: SKIP_ENV_VALIDATION
        value: false
      - key: REAL_TIME_STATS
        value: true
      - key: STAFF_REALTIME_ACCESS
        value: true
      - key: BRANCH_SELECTION_REQUIRED
        value: true
      - key: ANALYTICS_ENABLED
        value: true
      - key: SYSTEM_NAME
        value: Mopgomyouth
      - key: ORGANIZATION_NAME
        value: Mopgomglobal
      - key: SUPPORT_EMAIL
        value: admin@mopgomglobal.com
      - key: DEFAULT_ADMIN_EMAIL
        value: admin@mopgomglobal.com
      - key: DEFAULT_ADMIN_PASSWORD
        value: Admin123!
      - key: MINIMUM_AGE
        value: 13
      - key: REGISTRATION_OPEN
        value: true
      - key: ENABLE_SMS_NOTIFICATIONS
        value: false
      - key: ENABLE_EMAIL_NOTIFICATIONS
        value: true
      - key: QR_CODE_ENABLED
        value: true
      - key: AUTO_VERIFY_REGISTRATIONS
        value: false
      - key: ALLOW_DUPLICATE_REGISTRATIONS
        value: false
      - key: ENABLE_PARENTAL_PERMISSION
        value: true
      - key: ENABLE_EMERGENCY_CONTACTS
        value: true
      - key: ENABLE_MEDICAL_INFO
        value: true
      - key: ENABLE_DIETARY_RESTRICTIONS
        value: true
      - key: ENABLE_SPECIAL_NEEDS
        value: true
      - key: ENABLE_ACCOMMODATIONS
        value: true
      - key: ENABLE_ROOM_ALLOCATION
        value: true
      - key: ENABLE_QR_VERIFICATION
        value: true
      - key: ENABLE_BULK_OPERATIONS
        value: true
      - key: ENABLE_ANALYTICS
        value: true
      - key: ENABLE_REPORTS
        value: true
      - key: ENABLE_NOTIFICATIONS
        value: true
      - key: ENABLE_USER_MANAGEMENT
        value: true
      - key: ENABLE_ROLE_MANAGEMENT
        value: true
      - key: ENABLE_SETTINGS_MANAGEMENT
        value: true
      - key: ENABLE_BACKUP_RESTORE
        value: true
      - key: ENABLE_AUDIT_LOGS
        value: true
      - key: ENABLE_REAL_TIME_UPDATES
        value: true
      - key: ENABLE_MOBILE_RESPONSIVE
        value: true
      - key: ENABLE_DARK_MODE
        value: false
      - key: ENABLE_MULTI_LANGUAGE
        value: false
      - key: DEFAULT_LANGUAGE
        value: en
      - key: DEFAULT_TIMEZONE
        value: America/Los_Angeles
      - key: DEFAULT_CURRENCY
        value: USD
      - key: ENABLE_PAYMENT_PROCESSING
        value: false
      - key: ENABLE_SOCIAL_LOGIN
        value: false
      - key: ENABLE_TWO_FACTOR_AUTH
        value: false
      - key: SESSION_TIMEOUT_MINUTES
        value: 60
      - key: MAX_LOGIN_ATTEMPTS
        value: 5
      - key: PASSWORD_MIN_LENGTH
        value: 8
      - key: REQUIRE_PASSWORD_COMPLEXITY
        value: true
      - key: ENABLE_PASSWORD_RESET
        value: true
      - key: ENABLE_ACCOUNT_LOCKOUT
        value: true
      - key: ENABLE_SECURITY_HEADERS
        value: true
      - key: ENABLE_RATE_LIMITING
        value: true
      - key: ENABLE_CORS
        value: true
      - key: ENABLE_COMPRESSION
        value: true
      - key: ENABLE_CACHING
        value: true
      - key: CACHE_TTL_SECONDS
        value: 300
      - key: ENABLE_MONITORING
        value: true
      - key: LOG_LEVEL
        value: info
      - key: ENABLE_DEBUG_MODE
        value: false
